<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Voice Assistant</title>
<style>
body { font-family: Arial; text-align: center; margin: 50px; background: #f0f4f8; }
h1 { color: #2c3e50; }
#output { margin-top: 20px; font-size: 18px; white-space: pre-line; color: #34495e; }
.btn { padding: 15px 40px; font-size: 18px; border-radius: 12px; margin: 10px; cursor: pointer; color: white; border: none; transition:0.3s;}
#startBtn {background:#27ae60;} #startBtn:hover {background:#2ecc71;}
#stopBtn {background:#c0392b;} #stopBtn:hover {background:#e74c3c;}
</style>
</head>
<body>
<h1>ðŸŽ¤ My AI Assistant</h1>
<button id="startBtn" class="btn">Start Listening</button>
<button id="stopBtn" class="btn">Stop Listening</button>
<p id="output">Press "Start Listening" to talk.</p>

<script>
let recognition;
let listening = false;
const serverUrl = "http://YOUR_PC_IP:5000/chat"; // Change to your PC IP

if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SpeechRecognition();
    recognition.continuous = true;
    recognition.interimResults = false;
    recognition.lang = "en-US";

    recognition.onresult = async (event) => {
        const transcript = event.results[event.results.length-1][0].transcript;
        document.getElementById("output").innerText = "You: " + transcript;

        try {
            const response = await fetch(serverUrl, {
                method: "POST",
                headers: {"Content-Type":"application/json"},
                body: JSON.stringify({message: transcript, lang:"en"})
            });
            const data = await response.json();
            const reply = data.reply;
            document.getElementById("output").innerText += "\nAssistant: " + reply;

            const speech = new SpeechSynthesisUtterance(reply);
            speech.lang = "en-US";
            window.speechSynthesis.speak(speech);
        } catch(err) { console.error(err); }
    };

    recognition.onend = () => { if(listening) recognition.start(); };
} else { alert("Your browser does not support Speech Recognition."); }

document.getElementById("startBtn").onclick = () => {
    listening = true;
    recognition.start();
    
    // Say "How can I help you?"
    const speech = new SpeechSynthesisUtterance("How can I help you?");
    speech.lang = "en-US";
    window.speechSynthesis.speak(speech);

    document.getElementById("output").innerText = "ðŸŽ¤ Listening... How can I help you?";
};

document.getElementById("stopBtn").onclick = () => {
    listening = false;
    recognition.stop();
    document.getElementById("output").innerText = "ðŸ›‘ Stopped Listening.";
};
</script>
</body>
</html>
